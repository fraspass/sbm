# Estimating the stochastic blockmodel on a latent space of unknown dimension for an unknown number of communities

## Methodology

For simplicity, the embeddings will be generically denoted as <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/afecfaf331ef5d186ce64a9be457ab7d.svg?invert_in_darkmode" align=middle width=267.1428309pt height=27.9124395pt/> for some <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/ad64b477ecc18129fe9b235d89bd7a54.svg?invert_in_darkmode" align=middle width=51.48773685pt height=22.4657235pt/>, and the non-identifiable latent position <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/3e0fa3ff3c5539cdc0e09aed76998444.svg?invert_in_darkmode" align=middle width=16.6590336pt height=22.638462pt/> are more practically renamed <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/56fa4aecdf044ac082a31373cc0ad81d.svg?invert_in_darkmode" align=middle width=16.02834915pt height=14.6118786pt/>. The notation <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/2aa5d0cfa9ac37116f11e0443c6d1e96.svg?invert_in_darkmode" align=middle width=26.0487843pt height=14.6118786pt/> denotes the first <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/2103f85b8b1477f430fc407cad462224.svg?invert_in_darkmode" align=middle width=8.55596445pt height=22.8310566pt/> elements <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/d9cf27ab8ea9978e067dc5b146a9a2a8.svg?invert_in_darkmode" align=middle width=83.14428045pt height=24.657534pt/> of the vector <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/70be273b745beb375dc544763c727b86.svg?invert_in_darkmode" align=middle width=15.48422205pt height=14.6118786pt/>, and similarly <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/e1d3148ecf605c30c9fbd6ffa404e657.svg?invert_in_darkmode" align=middle width=26.0487843pt height=14.6118786pt/> denotes the last <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/559de9b66c7e81ca756bd5280353c7e6.svg?invert_in_darkmode" align=middle width=43.0802559pt height=22.8310566pt/> elements <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/1e99a6d2aca38f5684f5b4275d857823.svg?invert_in_darkmode" align=middle width=104.9004957pt height=24.657534pt/> of the vector. We assume that, given the number of communities <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/d6328eaebbcd5c358f426dbea4bdbf70.svg?invert_in_darkmode" align=middle width=15.13700595pt height=22.4657235pt/> and the latent dimension <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/2103f85b8b1477f430fc407cad462224.svg?invert_in_darkmode" align=middle width=8.55596445pt height=22.8310566pt/>, the embeddings are generated from <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/d6328eaebbcd5c358f426dbea4bdbf70.svg?invert_in_darkmode" align=middle width=15.13700595pt height=22.4657235pt/> <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/2103f85b8b1477f430fc407cad462224.svg?invert_in_darkmode" align=middle width=8.55596445pt height=22.8310566pt/>-dimensional community-specific Gaussians in the first <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/2103f85b8b1477f430fc407cad462224.svg?invert_in_darkmode" align=middle width=8.55596445pt height=22.8310566pt/> components, say <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/c714aa628b720cd9b4c8ecbc43c0fb00.svg?invert_in_darkmode" align=middle width=24.1833141pt height=22.4657235pt/>, and from a generic <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/49f50be6c56b16056a48557243d76fa5.svg?invert_in_darkmode" align=middle width=55.86568845pt height=24.657534pt/>-dimensional Gaussian (which is not cluster-specific) for the remaining components <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/b515eaf993addf8cd8a663c60844ce67.svg?invert_in_darkmode" align=middle width=24.1833141pt height=22.4657235pt/>. Therefore, introducing latent community assignments <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/0fbe66c1f30016944032b59dd3ffed07.svg?invert_in_darkmode" align=middle width=112.6615215pt height=24.657534pt/>, the model can be expressed as follows:

<p align="center"><img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/55b87051668cbe67dee0714e5ca38370.svg?invert_in_darkmode" align=middle width=619.5723072pt height=231.6803577pt/></p>

where <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/1ca2006f4cd689950a74e72a91091a21.svg?invert_in_darkmode" align=middle width=38.63261985pt height=22.4657235pt/> is the <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/877f17da0d7c756840fdc976d3c9e264.svg?invert_in_darkmode" align=middle width=43.4474007pt height=22.4657235pt/> probability simplex. Note that the inverse Wishart has been partially re-parametrised using a parameter <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/1bb6a4a3cd46c31f86edf629fac4d2f7.svg?invert_in_darkmode" align=middle width=45.63157335pt height=21.1872144pt/> and adding the corresponding dimension to obtain the required constraint <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/59d27f4580a6da5a1f33c7c387d77565.svg?invert_in_darkmode" align=middle width=67.95067785pt height=22.8310566pt/> for the generic parametrisation and interpretation of <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/b49211c7e49541e500c32b4d56d354dc.svg?invert_in_darkmode" align=middle width=9.16670205pt height=14.1552444pt/> in the inverse Wishart. Also note that <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/0e51a2dede42189d77627c4d742822c3.svg?invert_in_darkmode" align=middle width=14.4331011pt height=14.1552444pt/> can be chosen to be equal to <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/d6328eaebbcd5c358f426dbea4bdbf70.svg?invert_in_darkmode" align=middle width=15.13700595pt height=22.4657235pt/>, when fixed, for parsimony, or equal to <img src="https://rawgit.com/fraspass/sbm (fetch/master/svgs/55a049b8f161ae7cfeb0197d75aff967.svg?invert_in_darkmode" align=middle width=9.86687625pt height=14.1552444pt/> to have the maximum possible dimension of the embeddings.

## Understanding the code

The main part of the code is contained in the file `gibbs_sampler.jl`. The code also contains the implementation of an EM algorithm for a uniform - wrapped normal mixture model, used to initialise the algorithm. Finally, the code in `fft.jl` is used for periodicity detection from the sequence of raw data. For further extensions of this model, with a more flexible approach for modelling the human component, see the repository `fraspass/human_activity`.

## References

* Heard, N.A., Rubin-Delanchy, P.T.G. and Lawson, D.J. (2014). "Filtering automated polling traffic in computer network flow data". Proceedings - 2014 IEEE Joint Intelligence and Security Informatics Conference, JISIC 2014, 268-271. ([Link](https://ieeexplore.ieee.org/document/6975589/))
